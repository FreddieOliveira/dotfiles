#######################################
#               GENERAL               #
#######################################

# automatically renumber windows on creation/deletion
set-option -g renumber-windows on

# don't rename windows automatically
set -g allow-rename off

# remove delay when pressing ESC key (useful for vim users)
set -s escape-time 0

# use vi keybindings in copy mode
set-window-option -g mode-keys vi

# enable italic characters
set -g default-terminal "tmux-256color"
# set-option -ga terminal-overrides ",tmux-256color:Tc"


#######################################
#              SHORTCUTS              #
#######################################

# unbind default prefix and set it to Ctrl+g
unbind C-b
set -g prefix C-g

# config split horizontally to open in the current path with prefix+_
unbind "\""
bind _ split-window -c "#{pane_current_path}"

# config split horizontally to open in the current path with prefix+|
unbind % 
bind | split-window -h -c "#{pane_current_path}"

# config split horizontally to open int the current path
bind c new-window -c "#{pane_current_path}"

# bind a shortcut to synchronize commands on all panes in a window
bind y set synchronize-panes

# move current pane to given window
bind s command-prompt -p "Send pane to window:" "join-pane -t '%%'"

# focus given pane
bind 0 select-pane -t 0
bind 1 select-pane -t 1
bind 2 select-pane -t 2
bind 3 select-pane -t 3
bind 4 select-pane -t 4
bind 5 select-pane -t 5
bind 6 select-pane -t 6
bind 7 select-pane -t 7
bind 8 select-pane -t 8
bind 9 select-pane -t 9

# focus given window
bind -n M-0 select-window -t :=0
bind -n M-1 select-window -t :=1
bind -n M-2 select-window -t :=2
bind -n M-3 select-window -t :=3
bind -n M-4 select-window -t :=4
bind -n M-5 select-window -t :=5
bind -n M-6 select-window -t :=6
bind -n M-7 select-window -t :=7
bind -n M-8 select-window -t :=8
bind -n M-9 select-window -t :=9
bind -n M-- last-window

# move current window left and right
bind H swap-window -t -1
bind L swap-window -t +1

# focus up, down, left and right pane
bind k select-pane -U
bind j select-pane -D
bind h select-pane -L
bind l select-pane -R

# CMUS
bind M-b run-shell "cmus-remote -n"
bind M-v run-shell "cmus-remote -s"
bind M-c run-shell "cmus-remote -u"
bind M-x run-shell "cmus-remote -p"
bind M-z run-shell "cmus-remote -r"
bind M-s run-shell "cmus-remote -S"
bind M-r run-shell "cmus-remote -R"
bind M-C-r run-shell "cmus-remote -C \"toggle repeat_current\""
bind M-, run-shell "cmus-remote -C \"seek -30s\""
bind M-. run-shell "cmus-remote -C \"seek +30s\""


#######################################
#              STATUSBAR              #
#######################################

# refresh the status bar every 1 second.
set -g status-interval 1

# Time messages remain in the status bar in miliseconds.
# Lower this number if this is too distracting
set -g display-time 3000

# window notifications; display activity on other window
set -g monitor-activity on
set -g visual-activity on

# command/message line colors
set -g message-fg white
set -g message-bg black
set -g message-attr bright

# statusbar colors
set -g status-fg white
set -g status-bg black
set -g status-attr default

# LEFT SIDE -> Session: 0 0 0
cmus_status="#[fg=yellow]#(~/bin/cmus_status.sh status)"
cmus_artist="#[fg=green]#(~/bin/cmus_status.sh artist)"
cmus_song="#[fg=green]#(~/bin/cmus_status.sh song)"
cmus_repeat="#[fg=yellow]#(~/bin/cmus_status.sh repeat)"
cmus_shuffle="#[fg=yellow]#(~/bin/cmus_status.sh shuffle)"
set -g status-left-length 41
set -g status-left "$cmus_status $cmus_artist #[fg=blue]- $cmus_song $cmus_repeat $cmus_shuffle #[fg=#303030,bold]"

# CENTER
# colors when inactive
set -g window-status-fg cyan
set -g window-status-bg default
set -g window-status-attr dim
# colors when active
set -g window-status-current-fg colour81
set -g window-status-current-bg "#303030"
set -g window-status-current-attr bold
# actual content
set -g status-justify centre
set -g window-status-current-format " #I#[fg=colour250]:#[fg=colour81]#P#[fg=yellow]:#[fg=colour255]#W#[fg=colour50]#F "

# RIGHT SIDE ->  Day DD/MM/AA  HH:MM:SS
date="#[fg=white] #[fg=cyan]%a %d/%m/%y"
time="#[fg=white] #[fg=cyan]%T"
set -g status-right "#[fg=#303030,bold]  #[nobold]$date  $time"


#######################################
#               PLUGINS               #
#######################################

# Tmux Plugin Manager
set -g @plugin 'tmux-plugins/tpm'

# Restore tmux session
set -g @plugin 'tmux-plugins/tmux-resurrect'
# restore pane contents as well
set -g @resurrect-capture-pane-contents 'on'
# restore all programs running within the panes
set -g @resurrect-processes ':all:'
# restore shell history (experimental)
#set -g @resurrect-save-shell-history 'on'

# save and restore sessions (using tmux-resurrect) automatically
set -g @plugin 'tmux-plugins/tmux-continuum'
# interval in minutes to keep saving sessions
set -g @continuum-save-interval '10'
# automatically restore session whem tmux is started
set -g @continuum-restore 'on'
# automatically start tmux server with systemd
#set -g @continuum-boot 'on'


# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

